<!doctype html>
<html>
  <head>
  	<style type="text/css">
  	  #messages { list-style-type: none; margin: 0; padding: 0; }
      #messages li { padding: 5px 10px; }
      #messages li:nth-child(odd) { background: #eee; }

  	</style>
  </head>
  <body>
  	<div id ="window">
  		<h3>Chat</h3>
	  	<div id="chatWindow">
	  		<ul id="messages"></ul>
	  	</div>
	  	<div id="messageWindow">
	  		<div id ="status"></div>
	  		<form action="" id="chatForm">
	  			<input id="m" autocomplete="off" /><button>Send</button>
	  		</form>
	  	</div>
		
		<h3>Start Chat</h3>	
	  	
	  	<div id="signUp">
	  		<form action ="" id="signUpForm">
	  			Name: <input id="name"/>
	  			<br>
	  			Message: <input id="message"/>

	  			<button>Start Chat</button>

	  		</form>
	  	</div>

	</div>
	<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
	<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<script>

	var socket =io();
	$('#signUpForm').submit(function(){
	  socket.emit('startChat', $('#name').val(), $('#message').val());
	  return false;  
	});

	$('#chatForm').submit(function(){
		socket.emit('chatMessage', $('#m').val());
		appendMessage($('#m').val());
		$('#m').val('');
		return false;
	});

	socket.on('chatStarted', function(hasStarted){
	  if(hasStarted){
	    $('#signUp').hide();
	    $('#messageWindow').show();
	    //show messageWindow
	  }
	});

	socket.on('chatMessage', function(clientId, message){
		alert('chat message: ' + message);
		appendMessage(message);
	});

	socket.on('conversationCreated', function(conversation){
		$('#status').append($('<h3>').text('arsenal'));
	});


	socket.on('update', function(status){
	  $('#status').append($('<h3>').text(status));
	});

	function appendMessage(msg){
      $('#messages').append($('<li>').text(msg));
    }

	</script>
  </body>
</html>